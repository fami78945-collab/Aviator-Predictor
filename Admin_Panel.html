<!doctype HTML>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
            font-size: 14px;
            user-select: none; 
            -webkit-user-select: none; 
            -ms-user-select: none;
        }
        
        /* --- Loading Screen Styles --- */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }
        
        .loading-logo {
            width: 80px;
            height: auto;
            margin-bottom: 20px;
        }
        
        .loading-bar-container {
            width: 200px;
            height: 6px;
            background-color: #333;
            border-radius: 5px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .loading-bar {
            height: 100%;
            width: 0;
            background-color: #ff4500;
            animation: load 2s ease-in-out forwards;
        }

        @keyframes load {
            0% { width: 0; }
            100% { width: 100%; }
        }
        
        .loading-text {
            color: #ff4500;
            font-size: 16px;
            font-weight: bold;
        }

        /* --- Login Page Styles --- */
        .login-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            min-height: 100vh;
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 3000;
        }
        
        .login-container-box {
            max-width: 350px;
            width: 90%;
            padding: 25px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
            text-align: center;
        }

        .login-title {
            color: #ff6b6b;
            font-size: 1.5em;
            margin-bottom: 20px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .login-title i {
            margin-right: 10px;
            color: #e94560;
        }
        
        .admin-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #ff4500, #ff6b35);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            font-size: 24px;
            color: white;
        }
        
        .login-container-box .admin-form {
             gap: 15px;
        }
        
        .login-container-box .form-group input {
            padding: 10px;
            border-radius: 8px;
            font-size: 0.9em;
        }
        
        /* --- Admin Panel Styles --- */
        .admin-container {
            display: none;
            min-height: 100vh;
            max-width: 400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.05);
        }
        
        /* Left Sidebar */
        .admin-sidebar {
            width: 80px;
            background: linear-gradient(180deg, #0f3460, #533483);
            padding: 15px 5px;
            border-right: 1px solid #e94560;
            overflow-y: auto;
        }
        
        .sidebar-title {
            text-align: center;
            font-size: 0.8em;
            font-weight: bold;
            margin-bottom: 20px;
            color: #ff6b6b;
            padding-bottom: 8px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .sidebar-menu {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .menu-item {
            padding: 8px 5px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.7em;
            border: 1px solid transparent;
        }
        
        .menu-item:hover {
            background: rgba(233, 69, 96, 0.3);
        }
        
        .menu-item.active {
            background: rgba(233, 69, 96, 0.5);
            border-color: #e94560;
        }
        
        .menu-icon {
            font-size: 1em;
            margin-bottom: 3px;
            color: #ff6b6b;
        }
        
        /* Right Content Area */
        .admin-content {
            flex: 1;
            padding: 10px;
            overflow-y: auto;
        }
        
        .admin-header {
            background: linear-gradient(135deg, #0f3460, #533483);
            color: white;
            padding: 10px 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }

        .admin-title {
            font-size: 1.1em;
            font-weight: bold;
        }

        .logout-btn {
            background: #e94560;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.8em;
            transition: all 0.3s;
        }

        .logout-btn:hover {
            background: #ff6b6b;
        }

        .admin-section {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 12px;
            margin-bottom: 15px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(5px);
            display: none;
        }
        
        .admin-section.active {
            display: block;
            animation: fadeIn 0.3s ease-in-out;
        }

        .section-title {
            color: #e94560;
            font-size: 1em;
            margin-bottom: 12px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            padding-bottom: 8px;
            font-weight: bold;
        }

        .admin-form {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            text-align: left;
        }

        .form-group label {
            font-weight: bold;
            margin-bottom: 4px;
            color: #fff;
            font-size: 0.8em;
        }

        .form-group input, .form-group select, .form-group textarea {
            padding: 8px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 6px;
            font-size: 0.8em;
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }

        .form-group input::placeholder, .form-group textarea::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        .admin-button {
            background: linear-gradient(135deg, #e94560, #ff6b6b);
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            margin-top: 8px;
            transition: all 0.3s;
            box-shadow: 0 2px 6px rgba(233, 69, 96, 0.3);
            font-size: 0.8em;
        }

        .admin-button:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(233, 69, 96, 0.4);
        }

        .toggle-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
            padding: 6px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 6px;
        }

        .toggle-label {
            font-weight: bold;
            color: #fff;
            font-size: 0.8em;
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 35px;
            height: 18px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 18px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 14px;
            width: 14px;
            left: 2px;
            bottom: 2px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .toggle-slider {
            background-color: #e94560;
        }

        input:checked + .toggle-slider:before {
            transform: translateX(17px);
        }

        .time-selector {
            display: flex;
            gap: 8px;
            margin-bottom: 15px;
            background: rgba(255, 255, 255, 0.05);
            padding: 10px;
            border-radius: 8px;
        }

        .time-group {
            flex: 1;
            display: flex;
            flex-direction: column;
            text-align: left;
        }

        .time-group label {
            font-weight: bold;
            margin-bottom: 5px;
            color: #fff;
            font-size: 0.8em;
        }

        .time-group input {
            padding: 8px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 6px;
            font-size: 0.8em;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            width: 100%;
        }

        .generate-btn {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            box-shadow: 0 2px 6px rgba(40, 167, 69, 0.3);
            font-size: 0.8em;
            margin-top: 10px;
            width: 100%;
        }

        .generate-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(40, 167, 69, 0.4);
        }

        /* Key Items Styling */
        .key-item {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 8px;
            animation: slideIn 0.3s ease-out;
        }

        .key-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 6px;
        }

        .key-code {
            font-family: monospace;
            font-size: 0.9em;
            font-weight: bold;
            color: #ff6b6b;
            word-break: break-all;
        }

        .key-time {
            font-size: 0.7em;
            color: rgba(255, 255, 255, 0.7);
            text-align: right;
        }

        .key-actions {
            display: flex;
            gap: 6px;
            justify-content: flex-end;
        }

        .copy-key-btn, .delete-key-btn {
            padding: 4px 8px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.7em;
            transition: all 0.3s;
        }

        .copy-key-btn {
            background: #28a745;
            color: white;
        }

        .delete-key-btn {
            background: #e94560;
            color: white;
        }

        .copy-key-btn:hover {
            background: #218838;
        }

        .delete-key-btn:hover {
            background: #d13453;
        }

        .key-expiry {
            font-size: 0.7em;
            color: rgba(255, 255, 255, 0.6);
            margin-top: 4px;
            text-align: center;
        }

        .generated-message {
            background: rgba(40, 167, 69, 0.2);
            border: 1px solid #28a745;
            border-radius: 6px;
            padding: 8px;
            margin: 10px 0;
            text-align: center;
            color: #28a745;
            font-size: 0.8em;
            display: none;
            animation: fadeInOut 3s ease-in-out;
        }

        .keys-container {
            max-height: 300px;
            overflow-y: auto;
            margin-top: 15px;
        }

        .empty-state {
            text-align: center;
            color: rgba(255, 255, 255, 0.5);
            font-size: 0.8em;
            padding: 20px;
        }

        /* Statistics Section - UPDATED */
        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 15px;
        }

        .stat-card {
            background: linear-gradient(135deg, #0f3460, #533483);
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
        }

        .stat-icon {
            font-size: 1.2em;
            margin-bottom: 6px;
            color: #ff6b6b;
        }

        .stat-number {
            font-size: 1.1em;
            font-weight: bold;
            margin-bottom: 3px;
            color: #fff;
        }

        .stat-label {
            font-size: 0.7em;
            color: rgba(255, 255, 255, 0.8);
        }

        /* Prediction Settings */
        .prediction-subsection {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s;
        }

        .prediction-subsection.active {
            border: 2px solid #28a745;
            background: rgba(40, 167, 69, 0.15);
            box-shadow: 0 0 10px rgba(40, 167, 69, 0.3);
        }

        .subsection-title {
            color: #ff6b6b;
            font-size: 0.9em;
            margin-bottom: 8px;
            font-weight: bold;
        }

        /* Help Line Pages */
        .helpline-page {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 10px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .helpline-page-title {
            color: #ff6b6b;
            font-size: 0.9em;
            margin-bottom: 10px;
            font-weight: bold;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding-bottom: 5px;
        }

        /* Animations */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(5px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInOut {
            0% {
                opacity: 0;
                transform: translateY(-5px);
            }
            20% {
                opacity: 1;
                transform: translateY(0);
            }
            80% {
                opacity: 1;
                transform: translateY(0);
            }
            100% {
                opacity: 0;
                transform: translateY(-5px);
            }
        }

        /* Scrollbar Styling */
        ::-webkit-scrollbar {
            width: 4px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 2px;
        }

        ::-webkit-scrollbar-thumb {
            background: #e94560;
            border-radius: 2px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #ff6b6b;
        }

        /* Notification */
        .notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            z-index: 2000;
            display: none;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            max-width: 300px;
            text-align: center;
            font-size: 0.8em;
        }
    </style>
</head>
<body>
    
    <!-- Loading Screen -->
    <div class="loading-screen" id="loadingScreen">
        <div class="admin-icon">
            <i class="fas fa-user-shield"></i>
        </div>
        <div class="loading-text">Admin Panel Loading...</div>
        <div class="loading-bar-container">
            <div class="loading-bar"></div>
        </div>
    </div>

    <!-- Login Page -->
    <div class="login-overlay" id="loginOverlay">
        <div class="login-container-box">
            <div class="admin-icon">
                <i class="fas fa-user-shield"></i>
            </div>
            <div class="login-title">Admin Panel Login</div>
            
            <div class="admin-form">
                <div class="form-group">
                    <label for="loginPassword">Password</label>
                    <input type="password" id="loginPassword" placeholder="Enter Admin Password">
                    <div id="loginError" style="color: #ff6b6b; font-size: 0.8em; margin-top: 5px; display: none;"></div>
                </div>
                <button class="admin-button" onclick="adminLogin()">
                    <i class="fas fa-sign-in-alt"></i> Login
                </button>
            </div>
        </div>
    </div>

    <!-- Admin Panel -->
    <div class="admin-container">
        <div class="admin-sidebar">
            <div class="sidebar-title">Admin Menu</div>
            <div class="sidebar-menu">
                <div class="menu-item active" onclick="showSection('dashboard')">
                    <div class="menu-icon"><i class="fas fa-chart-bar"></i></div>
                    <div>Dashboard</div>
                </div>
                <div class="menu-item" onclick="showSection('users')">
                    <div class="menu-icon"><i class="fas fa-users"></i></div>
                    <div>Users</div>
                </div>
                <div class="menu-item" onclick="showSection('helpline')">
                    <div class="menu-icon"><i class="fas fa-headset"></i></div>
                    <div>Help Line</div>
                </div>
                <div class="menu-item" onclick="showSection('predictions')">
                    <div class="menu-icon"><i class="fas fa-cogs"></i></div>
                    <div>Predictions</div>
                </div>
                <div class="menu-item" onclick="showSection('settings')">
                    <div class="menu-icon"><i class="fas fa-key"></i></div> 
                    <div>Password</div>
                </div>
                <div class="menu-item" onclick="showSection('about')">
                    <div class="menu-icon"><i class="fas fa-info-circle"></i></div>
                    <div>About Us</div>
                </div>
            </div>
        </div>

        <div class="admin-content">
            <div class="admin-header">
                <div class="admin-title" id="contentTitle">Dashboard</div>
                <button class="logout-btn" onclick="adminLogout()">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </button>
            </div>

            <div class="admin-section active" id="dashboardSection">
                <div class="section-title">Real-time Statistics</div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-users"></i></div>
                        <div class="stat-number" id="activeUsers">0</div>
                        <div class="stat-label">Active Users</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-mouse-pointer"></i></div>
                        <div class="stat-number" id="totalPredictions">0</div>
                        <div class="stat-label">Total Predictions</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-key"></i></div>
                        <div class="stat-number" id="totalKeys">0</div>
                        <div class="stat-label">Active Keys</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-clock"></i></div>
                        <div class="stat-number" id="todayPredictions">0</div>
                        <div class="stat-label">Today's Predictions</div>
                    </div>
                </div>

                <div class="section-title" style="margin-top: 20px;">Recent Activity</div>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-user-plus"></i></div>
                        <div class="stat-number" id="newUsers">0</div>
                        <div class="stat-label">New Users (24h)</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-money-bill-wave"></i></div>
                        <div class="stat-number" id="revenue">0</div>
                        <div class="stat-label">Revenue</div>
                    </div>
                </div>
            </div>

            <div class="admin-section" id="usersSection">
                <div class="section-title">User Management</div>
                
                <div class="time-selector">
                    <div class="time-group">
                        <label for="userHours">Hours</label>
                        <input type="number" id="userHours" placeholder="Hours" min="0" max="720" value="0">
                    </div>
                    <div class="time-group">
                        <label for="userMinutes">Minutes</label>
                        <input type="number" id="userMinutes" placeholder="Minutes" min="0" max="59" value="10">
                    </div>
                </div>
                
                <button class="generate-btn" onclick="generateKey()">
                    <i class="fas fa-key"></i> Generate Key
                </button>

                <div class="generated-message" id="generatedMessage">
                    Key generated successfully!
                </div>
                
                <div class="keys-container" id="keysContainer">
                    <!-- Keys will be loaded here -->
                </div>
            </div>

            <div class="admin-section" id="helplineSection">
                <div class="section-title">Help Line Settings</div>

                <div class="helpline-page">
                    <div class="helpline-page-title">Login Page Help Line</div>
                    
                    <div class="toggle-container">
                        <div class="toggle-label">WhatsApp Link</div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="loginWhatsappEnabled" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="form-group">
                        <input type="text" id="loginWhatsappLink" placeholder="Enter WhatsApp link" value="https://wa.me/qr/CNV42SEAOIRPP1">
                    </div>
                    
                    <div class="toggle-container">
                        <div class="toggle-label">Telegram Link</div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="loginTelegramEnabled">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="form-group">
                        <input type="text" id="loginTelegramLink" placeholder="Enter Telegram link">
                    </div>
                    
                    <div class="toggle-container">
                        <div class="toggle-label">Phone Number</div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="loginPhoneEnabled">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="form-group">
                        <input type="text" id="loginPhoneNumber" placeholder="Enter phone number">
                    </div>
                </div>

                <div class="helpline-page">
                    <div class="helpline-page-title">Home Page Help Line</div>
                    
                    <div class="toggle-container">
                        <div class="toggle-label">WhatsApp Link</div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="homeWhatsappEnabled" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="form-group">
                        <input type="text" id="homeWhatsappLink" placeholder="Enter WhatsApp link" value="https://wa.me/qr/CNV42SEAOIRPP1">
                    </div>
                    
                    <div class="toggle-container">
                        <div class="toggle-label">Telegram Link</div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="homeTelegramEnabled">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="form-group">
                        <input type="text" id="homeTelegramLink" placeholder="Enter Telegram link">
                    </div>
                    
                    <div class="toggle-container">
                        <div class="toggle-label">Phone Number</div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="homePhoneEnabled">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="form-group">
                        <input type="text" id="homePhoneNumber" placeholder="Enter phone number">
                    </div>
                </div>
                
                <button class="admin-button" onclick="saveHelpLineSettings()">Save All Help Line Settings</button>
            </div>

            <div class="admin-section" id="predictionsSection">
                <div class="section-title">
                    Prediction Settings
                </div>

                <!-- Message System -->
                <div class="prediction-subsection" id="messageSection">
                    <div class="toggle-container">
                        <div class="toggle-label">Message System</div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="messageEnabled" onclick="togglePredictionMethod('message')">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="admin-form">
                        <div class="form-group">
                            <label for="customMessage">Message (one message per line)</label>
                            <textarea id="customMessage" rows="3" placeholder="Enter your messages here..."></textarea>
                        </div>
                        <button class="admin-button" onclick="saveMessageSettings()">Save Message</button>
                    </div>
                </div>

                <!-- Custom Results -->
                <div class="prediction-subsection" id="customSection">
                    <div class="toggle-container">
                        <div class="toggle-label">Custom Results</div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="customResultsEnabled" onclick="togglePredictionMethod('custom')">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="admin-form">
                        <div class="form-group">
                            <label for="customResults">Custom Results (one result per line)</label>
                            <textarea id="customResults" rows="3" placeholder="1.25&#10;2.50&#10;3.75&#10;..."></textarea>
                        </div>
                        <button class="admin-button" onclick="saveCustomResults()">Save Custom Results</button>
                    </div>
                </div>

                <!-- Gemini AI -->
                <div class="prediction-subsection" id="geminiAiSection">
                    <div class="toggle-container">
                        <div class="toggle-label">Google AI</div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="geminiAiEnabled" onclick="togglePredictionMethod('geminiAi')">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>

                <!-- Deepseek AI -->
                <div class="prediction-subsection" id="deepseekAiSection">
                    <div class="toggle-container">
                        <div class="toggle-label">Deepseek AI</div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="deepseekAiEnabled" onclick="togglePredictionMethod('deepseekAi')">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>

                <!-- API System -->
                <div class="prediction-subsection" id="apiSection">
                    <div class="toggle-container">
                        <div class="toggle-label">API System</div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="apiEnabled" onclick="togglePredictionMethod('api')">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="admin-form">
                        <div class="form-group">
                            <label for="apiKey">API Key</label>
                            <input type="text" id="apiKey" placeholder="Enter API Key">
                        </div>
                        <button class="admin-button" onclick="saveApiSettings()">Save API Settings</button>
                    </div>
                </div>

                <!-- Pattern Settings -->
                <div class="prediction-subsection" id="patternSection">
                    <div class="subsection-title">Result Pattern Settings</div>
                    <div class="form-group">
                        <label for="resultPattern">Select Result Display Pattern</label>
                        <select id="resultPattern" class="form-control">
                            <option value="sequential">Sequential (One by One in Order)</option>
                            <option value="random">Random Selection</option>
                        </select>
                    </div>
                    <button class="admin-button" onclick="savePatternSettings()">
                        <i class="fas fa-save"></i> Save Pattern
                    </button>
                </div>
            </div>

            <div class="admin-section" id="settingsSection">
                <div class="section-title">Password Settings</div>
                <div class="admin-form">
                    <div class="form-group">
                        <label for="currentAdminPassword">Current Password</label>
                        <input type="password" id="currentAdminPassword" placeholder="Current Password">
                    </div>
                    <div class="form-group">
                        <label for="newAdminPassword">New Password</label>
                        <input type="password" id="newAdminPassword" placeholder="New Password">
                    </div>
                    <div class="form-group">
                        <label for="confirmAdminPassword">Confirm Password</label>
                        <input type="password" id="confirmAdminPassword" placeholder="Confirm Password">
                    </div>
                    <button class="admin-button" onclick="changeAdminPassword()">Change Password</button>
                </div>
            </div>

            <div class="admin-section" id="aboutSection">
                <div class="section-title">About Us Settings</div>
                <div class="toggle-container">
                    <div class="toggle-label">Enable About Us Page</div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="aboutUsEnabled" checked>
                        <span class="toggle-slider"></span>
                    </label>
                </div>
                <div class="admin-form">
                    <div class="form-group">
                        <label>About Us Content</label>
                        <textarea id="aboutUsText" rows="3" placeholder="Enter about us content"></textarea>
                    </div>
                    <button class="admin-button" onclick="saveAboutUsSettings()">Save Settings</button>
                </div>
            </div>
        </div>
    </div>

    <div class="notification" id="notification"></div>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDbjKG5kTZXXYd6ZfG3caa1cQE0r6zVHgM",
            authDomain: "admin-15b0b.firebaseapp.com",
            databaseURL: "https://admin-15b0b-default-rtdb.firebaseio.com",
            projectId: "admin-15b0b",
            storageBucket: "admin-15b0b.firebasestorage.app",
            messagingSenderId: "362588279451",
            appId: "1:362588279451:web:66d5d72b80d6a471826c3e",
            measurementId: "G-4FD1HFPZT2"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // Global Variables
        let adminPassword = "admin123";
        let predictionSettings = {
            method: 'message',
            customResults: ["1.25x", "1.50x", "2.00x", "3.00x"],
            customMessages: ["Wait for signal", "Place your bet", "Cash out now", "High multiplier coming"],
            apiKey: '',
            deepseekApiKey: '',
            pattern: 'sequential'
        };
        let helplineSettings = {
            login: {
                whatsapp: { enabled: true, link: "https://wa.me/qr/CNV42SEAOIRPP1" },
                telegram: { enabled: false, link: "" },
                phone: { enabled: false, number: "" }
            },
            home: {
                whatsapp: { enabled: true, link: "https://wa.me/qr/CNV42SEAOIRPP1" },
                telegram: { enabled: false, link: "" },
                phone: { enabled: false, number: "" }
            }
        };
        let aboutUsSettings = {
            enabled: true,
            content: "Welcome to our exclusive VIP section. We provide top-tier services and a unique experience tailored for our most valued users."
        };
        
        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            // Show loading screen first
            const loadingScreen = document.getElementById('loadingScreen');
            const loginOverlay = document.getElementById('loginOverlay');
            
            // After 2 seconds, show login page
            setTimeout(() => {
                loadingScreen.style.display = 'none';
                
                // Load admin password and show login
                database.ref('adminPassword').once('value').then(snapshot => {
                    if (snapshot.exists()) {
                        adminPassword = snapshot.val();
                    }
                }).finally(() => {
                    loginOverlay.style.display = 'flex';
                    checkLoginStatus();
                });
            }, 2000);

            // Add Enter key listener for login form
            const loginPasswordInput = document.getElementById('loginPassword');
            if (loginPasswordInput) {
                loginPasswordInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        adminLogin();
                    }
                });
            }
        });

        // Check login status
        function checkLoginStatus() {
            const loginOverlay = document.getElementById('loginOverlay');
            const adminPanel = document.querySelector('.admin-container');
            
            if (sessionStorage.getItem('adminLoggedIn') === 'true') {
                loginOverlay.style.display = 'none';
                adminPanel.style.display = 'flex';
                
                loadSettingsFromFirebase();
                loadActiveKeys();
                updateRealStatistics();
                showSection('dashboard');
                if (predictionSettings.method) {
                    updatePredictionUi(predictionSettings.method);
                }
                startKeyCleanupInterval();
                
                // Start real-time statistics updates
                startRealTimeUpdates();
            }
        }
        
        // Admin Login
        function adminLogin() {
            const enteredPassword = document.getElementById('loginPassword').value;
            const passwordInput = document.getElementById('loginPassword');
            const errorElement = document.getElementById('loginError');
            
            errorElement.style.display = 'none';

            if (enteredPassword === adminPassword) {
                sessionStorage.setItem('adminLoggedIn', 'true');
                showNotification('âœ… Login successful!');
                setTimeout(() => {
                    window.location.reload();
                }, 1000);
            } else {
                passwordInput.value = '';
                errorElement.textContent = 'Invalid Password! Please try again. âŒ';
                errorElement.style.display = 'block';
                
                setTimeout(() => {
                    errorElement.style.display = 'none';
                }, 3000);
            }
        }
        
        // Admin Logout
        function adminLogout() {
            sessionStorage.removeItem('adminLoggedIn');
            showNotification('ðŸ”’ Logged out successfully!');
            setTimeout(() => {
                window.location.reload();
            }, 1000);
        }

        // Section Navigation
        function showSection(sectionName) {
            const sections = document.querySelectorAll('.admin-section');
            sections.forEach(section => {
                section.classList.remove('active');
            });
            
            const menuItems = document.querySelectorAll('.menu-item');
            menuItems.forEach(item => {
                item.classList.remove('active');
            });
            
            const activeSection = document.getElementById(sectionName + 'Section');
            if (activeSection) {
                activeSection.classList.add('active');
            }
            
            const activeMenuItem = document.querySelector(`.menu-item:nth-child(${getMenuItemIndex(sectionName)})`);
            if (activeMenuItem) {
                activeMenuItem.classList.add('active');
            }
            
            const titles = {
                'dashboard': 'Dashboard',
                'users': 'User Management',
                'helpline': 'Help Line Settings',
                'predictions': 'Prediction Settings',
                'settings': 'Password Settings',
                'about': 'About Us Settings'
            };
            document.getElementById('contentTitle').textContent = titles[sectionName] || 'Admin Panel';
            
            // Refresh statistics when dashboard is shown
            if (sectionName === 'dashboard') {
                updateRealStatistics();
            }
        }
        
        function getMenuItemIndex(sectionName) {
            const menuOrder = ['dashboard', 'users', 'helpline', 'predictions', 'settings', 'about'];
            return menuOrder.indexOf(sectionName) + 1;
        }

        // Start real-time statistics updates
        function startRealTimeUpdates() {
            // Update statistics every 10 seconds
            setInterval(() => {
                updateRealStatistics();
            }, 10000);
        }

        // Update REAL Statistics from Firebase
        function updateRealStatistics() {
            const now = Date.now();
            const todayStart = new Date();
            todayStart.setHours(0, 0, 0, 0);
            
            // Active Users (keys that are not expired)
            database.ref('keys').once('value').then(snapshot => {
                let activeUsers = 0;
                if (snapshot.exists()) {
                    const keys = snapshot.val();
                    for (const key in keys) {
                        if (keys[key].expiry > now) {
                            activeUsers++;
                        }
                    }
                }
                document.getElementById('activeUsers').textContent = activeUsers;
                document.getElementById('totalKeys').textContent = activeUsers;
            });

            // Total Predictions
            database.ref('predictions').once('value').then(snapshot => {
                const totalPredictions = snapshot.exists() ? Object.keys(snapshot.val()).length : 0;
                document.getElementById('totalPredictions').textContent = totalPredictions;
            });

            // Today's Predictions
            database.ref('predictions').once('value').then(snapshot => {
                let todayPredictions = 0;
                if (snapshot.exists()) {
                    const predictions = snapshot.val();
                    for (const key in predictions) {
                        if (predictions[key].timestamp >= todayStart.getTime()) {
                            todayPredictions++;
                        }
                    }
                }
                document.getElementById('todayPredictions').textContent = todayPredictions;
            });

            // New Users (last 24 hours)
            database.ref('keys').once('value').then(snapshot => {
                let newUsers = 0;
                const yesterday = now - (24 * 60 * 60 * 1000);
                if (snapshot.exists()) {
                    const keys = snapshot.val();
                    for (const key in keys) {
                        if (keys[key].created >= yesterday) {
                            newUsers++;
                        }
                    }
                }
                document.getElementById('newUsers').textContent = newUsers;
            });

            // Revenue (simulated based on active users)
            database.ref('keys').once('value').then(snapshot => {
                let activeUsers = 0;
                if (snapshot.exists()) {
                    const keys = snapshot.val();
                    for (const key in keys) {
                        if (keys[key].expiry > now) {
                            activeUsers++;
                        }
                    }
                }
                const revenue = activeUsers * 10; // $10 per user
                document.getElementById('revenue').textContent = '$' + revenue;
            });
        }

        // Load settings from Firebase
        function loadSettingsFromFirebase() {
            database.ref('predictionSettings').once('value').then(snapshot => {
                if (snapshot.exists()) {
                    predictionSettings = snapshot.val();
                    console.log('âœ… Admin Panel: Prediction settings loaded:', predictionSettings);
                    updatePredictionUI();
                }
            });

            database.ref('helplineSettings').once('value').then(snapshot => {
                if (snapshot.exists()) {
                    helplineSettings = snapshot.val();
                    updateHelplineUI();
                }
            });

            database.ref('aboutUsSettings').once('value').then(snapshot => {
                if (snapshot.exists()) {
                    aboutUsSettings = snapshot.val();
                    updateAboutUsUI();
                }
            });
        }

        // Update Prediction UI
        function updatePredictionUI() {
            document.getElementById('messageEnabled').checked = predictionSettings.method === 'message';
            document.getElementById('customResultsEnabled').checked = predictionSettings.method === 'custom';
            document.getElementById('geminiAiEnabled').checked = predictionSettings.method === 'geminiAi';
            document.getElementById('deepseekAiEnabled').checked = predictionSettings.method === 'deepseekAi';
            document.getElementById('apiEnabled').checked = predictionSettings.method === 'api';
            
            document.getElementById('customMessage').value = Array.isArray(predictionSettings.customMessages) ? predictionSettings.customMessages.join('\n') : '';
            document.getElementById('customResults').value = Array.isArray(predictionSettings.customResults) ? predictionSettings.customResults.join('\n') : '';
            document.getElementById('apiKey').value = predictionSettings.apiKey || '';
            document.getElementById('resultPattern').value = predictionSettings.pattern || 'sequential';
            
            updatePredictionUi(predictionSettings.method);
        }

        // Update Helpline UI
        function updateHelplineUI() {
            document.getElementById('loginWhatsappEnabled').checked = helplineSettings.login.whatsapp.enabled;
            document.getElementById('loginWhatsappLink').value = helplineSettings.login.whatsapp.link;
            document.getElementById('loginTelegramEnabled').checked = helplineSettings.login.telegram.enabled;
            document.getElementById('loginTelegramLink').value = helplineSettings.login.telegram.link;
            document.getElementById('loginPhoneEnabled').checked = helplineSettings.login.phone.enabled;
            document.getElementById('loginPhoneNumber').value = helplineSettings.login.phone.number;
            
            document.getElementById('homeWhatsappEnabled').checked = helplineSettings.home.whatsapp.enabled;
            document.getElementById('homeWhatsappLink').value = helplineSettings.home.whatsapp.link;
            document.getElementById('homeTelegramEnabled').checked = helplineSettings.home.telegram.enabled;
            document.getElementById('homeTelegramLink').value = helplineSettings.home.telegram.link;
            document.getElementById('homePhoneEnabled').checked = helplineSettings.home.phone.enabled;
            document.getElementById('homePhoneNumber').value = helplineSettings.home.phone.number;
        }

        // Update About Us UI
        function updateAboutUsUI() {
            document.getElementById('aboutUsEnabled').checked = aboutUsSettings.enabled;
            document.getElementById('aboutUsText').value = aboutUsSettings.content;
        }

        // Toggle Prediction Method
        function togglePredictionMethod(method) {
            document.getElementById('messageEnabled').checked = method === 'message';
            document.getElementById('customResultsEnabled').checked = method === 'custom';
            document.getElementById('geminiAiEnabled').checked = method === 'geminiAi';
            document.getElementById('deepseekAiEnabled').checked = method === 'deepseekAi';
            document.getElementById('apiEnabled').checked = method === 'api';
            
            predictionSettings.method = method;
            
            database.ref('predictionSettings').set(predictionSettings)
                .then(() => {
                    updatePredictionUi(method);
                    showNotification(`âœ… Prediction method set to: ${method}`);
                })
                .catch(error => {
                    showNotification('âŒ Failed to save prediction method!');
                });
        }

        // Update Prediction UI
        function updatePredictionUi(method) {
            const subsections = document.querySelectorAll('.prediction-subsection');
            subsections.forEach(subsection => {
                subsection.classList.remove('active');
            });
            
            const activeSubsection = document.getElementById(method + 'Section');
            if (activeSubsection) {
                activeSubsection.classList.add('active');
            }
        }

        // Save Message Settings
        function saveMessageSettings() {
            const messageText = document.getElementById('customMessage').value;
            predictionSettings.customMessages = messageText.split('\n')
                .map(msg => msg.trim())
                .filter(msg => msg !== '');
            
            predictionSettings.method = 'message';
            
            database.ref('predictionSettings').set(predictionSettings)
                .then(() => {
                    showNotification('âœ… Message settings saved successfully!');
                    updatePredictionUI();
                })
                .catch(error => {
                    showNotification('âŒ Failed to save message settings!');
                });
        }

        // Save Custom Results
        function saveCustomResults() {
            const resultsText = document.getElementById('customResults').value;
            predictionSettings.customResults = resultsText.split('\n')
                .map(result => result.trim())
                .filter(result => result !== '');
            
            predictionSettings.method = 'custom';
            
            database.ref('predictionSettings').set(predictionSettings)
                .then(() => {
                    showNotification('âœ… Custom results saved successfully!');
                    updatePredictionUI();
                })
                .catch(error => {
                    showNotification('âŒ Failed to save custom results!');
                });
        }

        // Save API Settings
        function saveApiSettings() {
            predictionSettings.apiKey = document.getElementById('apiKey').value;
            
            database.ref('predictionSettings').set(predictionSettings)
                .then(() => {
                    showNotification('âœ… API settings saved successfully!');
                })
                .catch(error => {
                    showNotification('âŒ Failed to save API settings!');
                });
        }

        // Save Pattern Settings
        function savePatternSettings() {
            const pattern = document.getElementById('resultPattern').value;
            predictionSettings.pattern = pattern;
            
            database.ref('predictionSettings').set(predictionSettings)
                .then(() => {
                    showNotification(`âœ… Pattern set to: ${pattern}`);
                })
                .catch(error => {
                    showNotification('âŒ Failed to save pattern!');
                });
        }

        // Save Help Line Settings
        function saveHelpLineSettings() {
            helplineSettings.login.whatsapp.enabled = document.getElementById('loginWhatsappEnabled').checked;
            helplineSettings.login.whatsapp.link = document.getElementById('loginWhatsappLink').value;
            helplineSettings.login.telegram.enabled = document.getElementById('loginTelegramEnabled').checked;
            helplineSettings.login.telegram.link = document.getElementById('loginTelegramLink').value;
            helplineSettings.login.phone.enabled = document.getElementById('loginPhoneEnabled').checked;
            helplineSettings.login.phone.number = document.getElementById('loginPhoneNumber').value;
            
            helplineSettings.home.whatsapp.enabled = document.getElementById('homeWhatsappEnabled').checked;
            helplineSettings.home.whatsapp.link = document.getElementById('homeWhatsappLink').value;
            helplineSettings.home.telegram.enabled = document.getElementById('homeTelegramEnabled').checked;
            helplineSettings.home.telegram.link = document.getElementById('homeTelegramLink').value;
            helplineSettings.home.phone.enabled = document.getElementById('homePhoneEnabled').checked;
            helplineSettings.home.phone.number = document.getElementById('homePhoneNumber').value;
            
            database.ref('helplineSettings').set(helplineSettings)
                .then(() => {
                    showNotification('âœ… Help Line settings saved successfully!');
                })
                .catch(error => {
                    showNotification('âŒ Failed to save Help Line settings!');
                });
        }

        // Save About Us Settings
        function saveAboutUsSettings() {
            aboutUsSettings.enabled = document.getElementById('aboutUsEnabled').checked;
            aboutUsSettings.content = document.getElementById('aboutUsText').value;
            
            database.ref('aboutUsSettings').set(aboutUsSettings)
                .then(() => {
                    showNotification('âœ… About Us settings saved successfully!');
                })
                .catch(error => {
                    showNotification('âŒ Failed to save About Us settings!');
                });
        }

        // Generate Key
        function generateKey() {
            const hours = parseInt(document.getElementById('userHours').value) || 0;
            const minutes = parseInt(document.getElementById('userMinutes').value) || 0;
            
            if (hours === 0 && minutes === 0) {
                showNotification('âŒ Please enter a valid time duration!');
                return;
            }
            
            const totalMinutes = hours * 60 + minutes;
            const key = generateRandomKey(8); 
            const expiryTime = Date.now() + (totalMinutes * 60 * 1000);
            
            database.ref('keys/' + key).set({
                key: key,
                created: Date.now(),
                expiry: expiryTime,
                duration: totalMinutes
            })
            .then(() => {
                const message = document.getElementById('generatedMessage');
                message.style.display = 'block';
                setTimeout(() => {
                    message.style.display = 'none';
                }, 3000);
                
                loadActiveKeys();
                updateRealStatistics();
                showNotification(`âœ… Key **${key}** generated successfully! âœ¨`);
            })
            .catch(error => {
                showNotification('âŒ Failed to generate key!');
            });
        }

        function generateRandomKey(length = 8) { 
            const charsUpper = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            const charsLower = 'abcdefghijklmnopqrstuvwxyz';
            const charsNumber = '0123456789';
            const allChars = charsUpper + charsLower + charsNumber;
            let result = '';
            
            for (let i = 0; i < length; i++) {
                let charSet = allChars;
                
                if (i % 3 === 0) charSet = charsUpper;
                else if (i % 3 === 1) charSet = charsNumber;
                else charSet = charsLower;
                
                result += charSet.charAt(Math.floor(Math.random() * charSet.length));
            }
            
            return result.slice(0, length);
        }

        // Load Active Keys
        function loadActiveKeys() {
            const keysContainer = document.getElementById('keysContainer');
            if (keysContainer) {
                 keysContainer.innerHTML = '<div class="empty-state">Loading keys...</div>';
            }
           
            database.ref('keys').once('value').then(snapshot => {
                if (!snapshot.exists()) {
                    if (keysContainer) {
                        keysContainer.innerHTML = '<div class="empty-state">No active keys found</div>';
                    }
                    return;
                }
                
                const keys = snapshot.val();
                let keysHTML = '';
                let activeCount = 0;
                const now = Date.now();
                
                for (const key in keys) {
                    const keyData = keys[key];
                    
                    if (keyData.expiry < now) {
                        database.ref('keys/' + key).remove();
                        continue;
                    }
                    
                    activeCount++;
                    const timeLeft = formatTimeLeft(keyData.expiry - now);
                    
                    keysHTML += `
                        <div class="key-item">
                            <div class="key-header">
                                <div class="key-code">${keyData.key}</div>
                                <div class="key-time">${formatDate(keyData.created)}</div>
                            </div>
                            <div class="key-expiry">Expires in: ${timeLeft}</div>
                            <div class="key-actions">
                                <button class="copy-key-btn" onclick="copyKey('${keyData.key}')">
                                    <i class="fas fa-copy"></i> Copy
                                </button>
                                <button class="delete-key-btn" onclick="deleteKey('${keyData.key}')">
                                    <i class="fas fa-trash"></i> Delete
                                </button>
                            </div>
                        </div>
                    `;
                }
                
                if (keysContainer) {
                    if (activeCount === 0) {
                        keysContainer.innerHTML = '<div class="empty-state">No active keys found</div>';
                    } else {
                        keysContainer.innerHTML = keysHTML;
                    }
                }
            }).catch(error => {
                if (keysContainer) {
                    keysContainer.innerHTML = '<div class="empty-state">Error loading keys</div>';
                }
            });
        }

        // Copy Key
        function copyKey(key) {
            if (navigator.clipboard && window.isSecureContext) {
                navigator.clipboard.writeText(key)
                    .then(() => {
                        showNotification('âœ… Key copied to clipboard!');
                    })
                    .catch(err => {
                        fallbackCopyTextToClipboard(key);
                    });
            } else {
                fallbackCopyTextToClipboard(key);
            }
        }

        // Fallback function for copying text
        function fallbackCopyTextToClipboard(text) {
            const textArea = document.createElement("textarea");
            textArea.value = text;
            
            textArea.style.position = "fixed";
            textArea.style.top = 0;
            textArea.style.left = 0;
            textArea.style.width = "2em";
            textArea.style.height = "2em";
            textArea.style.padding = 0;
            textArea.style.border = "none";
            textArea.style.outline = "none";
            textArea.style.boxShadow = "none";
            textArea.style.background = "transparent";

            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();

            try {
                const successful = document.execCommand('copy');
                if (successful) {
                    showNotification('âœ… Key copied to clipboard!');
                } else {
                    showNotification('âŒ Copy failed! Please copy manually.');
                }
            } catch (err) {
                showNotification('âŒ Copy failed! Manual copy required.');
            }

            document.body.removeChild(textArea);
        }

        // Delete Key
        function deleteKey(key) {
            if (confirm(`Are you sure you want to delete key: ${key}?`)) {
                database.ref('keys/' + key).remove().then(() => {
                    loadActiveKeys();
                    updateRealStatistics();
                    showNotification(`âœ… Key **${key}** deleted successfully! ðŸ—‘ï¸`);
                }).catch(error => {
                    showNotification('âŒ Deletion failed!');
                });
            }
        }

        // Format Date
        function formatDate(timestamp) {
            const date = new Date(timestamp);
            return date.toLocaleDateString() + ' ' + date.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
        }

        // Format Time Left
        function formatTimeLeft(milliseconds) {
            const hours = Math.floor(milliseconds / (1000 * 60 * 60));
            const minutes = Math.floor((milliseconds % (1000 * 60 * 60)) / (1000 * 60));
            
            if (hours > 0) {
                return `${hours}h ${minutes}m`;
            } else {
                return `${minutes}m`;
            }
        }

        // Change Admin Password
        function changeAdminPassword() {
            const currentPassword = document.getElementById('currentAdminPassword').value;
            const newPassword = document.getElementById('newAdminPassword').value;
            const confirmPassword = document.getElementById('confirmAdminPassword').value;
            
            if (currentPassword !== adminPassword) {
                showNotification('âŒ Current password is incorrect!');
                return;
            }
            
            if (newPassword !== confirmPassword) {
                showNotification('âŒ New passwords do not match!');
                return;
            }
            
            if (newPassword.length < 6) {
                showNotification('âŒ Password must be at least 6 characters long!');
                return;
            }
            
            adminPassword = newPassword;
            database.ref('adminPassword').set(newPassword)
                .then(() => {
                    document.getElementById('currentAdminPassword').value = '';
                    document.getElementById('newAdminPassword').value = '';
                    document.getElementById('confirmAdminPassword').value = '';
                    
                    showNotification('âœ… Password changed successfully!');
                })
                .catch(error => {
                    showNotification('âŒ Failed to change password!');
                });
        }

        // Show Notification
        function showNotification(message) {
            const notification = document.getElementById('notification');
            
            const formattedMessage = message.replace(/\*\*(.*?)\*\*/g, '<b>$1</b>');
            
            notification.innerHTML = formattedMessage;
            notification.style.display = 'block';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }

        // Start automatic key cleanup
        function startKeyCleanupInterval() {
            setInterval(() => {
                loadActiveKeys();
            }, 60000);
        }
    </script>
</body>
</html>